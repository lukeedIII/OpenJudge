<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 450" width="100%" height="100%">
  <defs>
    <!-- Background Gradient -->
    <linearGradient id="bg" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" stop-color="#05060a"/>
      <stop offset="50%" stop-color="#0a0c14"/>
      <stop offset="100%" stop-color="#020305"/>
    </linearGradient>

    <!-- Glass Panel Gradient -->
    <linearGradient id="glass" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="rgba(255, 255, 255, 0.04)" />
      <stop offset="100%" stop-color="rgba(255, 255, 255, 0.01)" />
    </linearGradient>

    <!-- Glowing Lines -->
    <linearGradient id="cyanLine" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" stop-color="#00f2fe"/>
      <stop offset="100%" stop-color="#4facfe"/>
    </linearGradient>
    <linearGradient id="orangeLine" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" stop-color="#ff4b2b"/>
      <stop offset="100%" stop-color="#ff416c"/>
    </linearGradient>
    <linearGradient id="greenLine" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" stop-color="#00ff88"/>
      <stop offset="100%" stop-color="#00df6d"/>
    </linearGradient>

    <!-- Filters -->
    <filter id="glow-cyan" x="-50%" y="-50%" width="200%" height="200%">
      <feGaussianBlur stdDeviation="8" result="blur" />
      <feMerge>
        <feMergeNode in="blur" />
        <feMergeNode in="SourceGraphic" />
      </feMerge>
    </filter>
    <filter id="glow-orange" x="-50%" y="-50%" width="200%" height="200%">
      <feGaussianBlur stdDeviation="8" result="blur" />
      <feMerge>
        <feMergeNode in="blur" />
        <feMergeNode in="SourceGraphic" />
      </feMerge>
    </filter>
    <filter id="glow-green" x="-50%" y="-50%" width="200%" height="200%">
      <feGaussianBlur stdDeviation="8" result="blur" />
      <feMerge>
        <feMergeNode in="blur" />
        <feMergeNode in="SourceGraphic" />
      </feMerge>
    </filter>
    <filter id="lightGlow" x="-50%" y="-50%" width="200%" height="200%">
      <feGaussianBlur stdDeviation="3" result="blur" />
      <feMerge>
        <feMergeNode in="blur" />
        <feMergeNode in="SourceGraphic" />
      </feMerge>
    </filter>
    
    <!-- Path animations -->
    <marker id="arrow-cyan" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#00f2fe" filter="url(#lightGlow)"/>
    </marker>
    <marker id="arrow-orange" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#ff4b2b" filter="url(#lightGlow)"/>
    </marker>
    <marker id="arrow-green" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#00ff88" filter="url(#lightGlow)"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1200" height="450" rx="16" fill="url(#bg)"/>
  
  <g opacity="0.08">
    <pattern id="grid" width="30" height="30" patternUnits="userSpaceOnUse">
      <path d="M 30 0 L 0 0 0 30" fill="none" stroke="#4facfe" stroke-width="1"/>
    </pattern>
    <rect width="1200" height="450" rx="16" fill="url(#grid)"/>
  </g>

  <!-- Title -->
  <text x="600" y="55" font-family="'Inter', Arial, sans-serif" font-weight="900" font-size="22" fill="#ffffff" letter-spacing="4" text-anchor="middle" filter="url(#lightGlow)">
    V3 ENTERPRISE <tspan fill="#00f2fe">MICROSERVICE ARCHITECTURE</tspan>
  </text>
  <line x1="100" y1="75" x2="1100" y2="75" stroke="rgba(255,255,255,0.05)" stroke-width="1"/>
  
  
  <!-- ============================================== -->
  <!-- LEFT PANEL: CLIENT ENVIRONMENT                 -->
  <!-- ============================================== -->
  <g transform="translate(80, 120)">
    <!-- Container -->
    <rect width="280" height="260" rx="12" fill="url(#glass)" stroke="#1a2030" stroke-width="2"/>
    <text x="140" y="35" font-family="'Inter', Arial, sans-serif" font-weight="900" font-size="16" fill="#8892b0" text-anchor="middle" letter-spacing="2">CLIENT ENVIRONMENT</text>
    
    <!-- BYOT Provider -->
    <g transform="translate(20, 70)">
      <rect width="240" height="60" rx="8" fill="#05060a" stroke="#1f2536" stroke-width="1.5"/>
      <line x1="0" y1="0" x2="0" y2="60" stroke="#00f2fe" stroke-width="4" filter="url(#lightGlow)"/>
      <text x="25" y="25" font-family="'Inter', Arial, sans-serif" font-size="14" font-weight="bold" fill="#ffffff">Backend Application</text>
      <text x="25" y="45" font-family="'Consolas', monospace" font-size="12" fill="#4facfe">engine.register_tool()</text>
    </g>

    <!-- Observer UI -->
    <g transform="translate(20, 160)">
      <rect width="240" height="60" rx="8" fill="#05060a" stroke="#1f2536" stroke-width="1.5"/>
      <line x1="0" y1="0" x2="0" y2="60" stroke="#ff416c" stroke-width="4" filter="url(#lightGlow)"/>
      <text x="25" y="25" font-family="'Inter', Arial, sans-serif" font-size="14" font-weight="bold" fill="#ffffff">Observer GUI (React)</text>
      <text x="25" y="45" font-family="'Consolas', monospace" font-size="12" fill="#ff4b2b">yield JSON SSE Stream</text>
    </g>
  </g>

  <!-- ============================================== -->
  <!-- CENTER PANEL: OPENJUDGE V3 SDK & API           -->
  <!-- ============================================== -->
  <g transform="translate(440, 120)">
    
    <!-- Core Ambient Glow -->
    <circle cx="160" cy="130" r="140" fill="url(#cyanLine)" opacity="0.03" filter="url(#glow-cyan)">
      <animate attributeName="opacity" values="0.02; 0.05; 0.02" dur="4s" repeatCount="indefinite" />
    </circle>
    
    <!-- Container -->
    <rect width="320" height="260" rx="12" fill="url(#glass)" stroke="url(#neonCyan)" stroke-width="1.5" filter="url(#lightGlow)"/>
    <text x="160" y="35" font-family="'Inter', Arial, sans-serif" font-weight="900" font-size="16" fill="#00f2fe" text-anchor="middle" letter-spacing="2" filter="url(#lightGlow)">OPENJUDGE V3 SDK</text>
    
    <!-- FastAPI Wrapper -->
    <g transform="translate(30, 60)">
      <rect width="260" height="40" rx="6" fill="#05060a" stroke="#00ff88" stroke-width="1"/>
      <text x="130" y="25" font-family="'Consolas', monospace" font-size="14" font-weight="bold" fill="#00ff88" text-anchor="middle" filter="url(#lightGlow)">FastAPI HTTP Microservice</text>
    </g>

    <!-- BYOT Registry -->
    <g transform="translate(30, 115)">
      <rect width="260" height="40" rx="6" fill="#05060a" stroke="#4facfe" stroke-width="1"/>
      <text x="130" y="25" font-family="'Consolas', monospace" font-size="14" fill="#ffffff" text-anchor="middle">Enterprise BYOT Registry</text>
    </g>

    <!-- Validation Ledger -->
    <g transform="translate(30, 170)">
      <rect width="260" height="70" rx="6" fill="rgba(255, 75, 43, 0.05)" stroke="#ff4b2b" stroke-width="1.5" filter="url(#glow-orange)"/>
      <circle cx="30" cy="35" r="5" fill="#ff4b2b">
        <animate attributeName="opacity" values="1; 0.2; 1" dur="1.5s" repeatCount="indefinite"/>
      </circle>
      <text x="140" y="30" font-family="'Consolas', monospace" font-size="14" font-weight="bold" fill="#ffffff" text-anchor="middle">State Manager &amp; Ledger</text>
      <text x="140" y="50" font-family="'Consolas', monospace" font-size="11" fill="#8892b0" text-anchor="middle">(Empirical Math Verification)</text>
    </g>
    
    <!-- Connection lines inside Center panel -->
    <line x1="160" y1="100" x2="160" y2="115" stroke="#1f2536" stroke-width="2"/>
    <line x1="160" y1="155" x2="160" y2="170" stroke="#1f2536" stroke-width="2"/>
  </g>

  <!-- ============================================== -->
  <!-- RIGHT PANEL: LLM INFERENCE                     -->
  <!-- ============================================== -->
  <g transform="translate(840, 120)">
    <!-- Container -->
    <rect width="280" height="260" rx="12" fill="url(#glass)" stroke="#1a2030" stroke-width="2"/>
    <text x="140" y="35" font-family="'Inter', Arial, sans-serif" font-weight="900" font-size="16" fill="#8892b0" text-anchor="middle" letter-spacing="2">LLM GATEWAY</text>
    
    <g transform="translate(140, 130)">
      <!-- Neural Nodes animation -->
      <g stroke="#1f2536" stroke-width="1.5">
        <line x1="0" y1="0" x2="-50" y2="-50"/>
        <line x1="0" y1="0" x2="50" y2="-50"/>
        <line x1="0" y1="0" x2="-50" y2="50"/>
        <line x1="0" y1="0" x2="50" y2="50"/>
      </g>
      
      <!-- Flowing energy in neural network -->
      <circle r="2.5" fill="#00ff88" filter="url(#lightGlow)">
        <animateMotion dur="1.5s" repeatCount="indefinite" path="M 0 0 L -50 -50" />
        <animate attributeName="opacity" values="1; 0" dur="1.5s" repeatCount="indefinite"/>
      </circle>
      <circle r="2.5" fill="#4facfe" filter="url(#lightGlow)">
        <animateMotion dur="1.2s" repeatCount="indefinite" path="M 0 0 L 50 -50" />
        <animate attributeName="opacity" values="1; 0" dur="1.2s" repeatCount="indefinite"/>
      </circle>
      <circle r="2.5" fill="#ff416c" filter="url(#lightGlow)">
        <animateMotion dur="1.8s" repeatCount="indefinite" path="M 0 0 L -50 50" />
        <animate attributeName="opacity" values="1; 0" dur="1.8s" repeatCount="indefinite"/>
      </circle>
      <circle r="2.5" fill="#00ff88" filter="url(#lightGlow)">
        <animateMotion dur="1.4s" repeatCount="indefinite" path="M 0 0 L 50 50" />
        <animate attributeName="opacity" values="1; 0" dur="1.4s" repeatCount="indefinite"/>
      </circle>

      <circle cx="-50" cy="-50" r="14" fill="#05060a" stroke="#00ff88" stroke-width="1.5"/>
      <circle cx="50" cy="-50" r="14" fill="#05060a" stroke="#4facfe" stroke-width="1.5"/>
      <circle cx="-50" cy="50" r="14" fill="#05060a" stroke="#ff416c" stroke-width="1.5"/>
      <circle cx="50" cy="50" r="14" fill="#05060a" stroke="#00ff88" stroke-width="1.5"/>
      
      <circle cx="0" cy="0" r="30" fill="#060810" stroke="#ffffff" stroke-width="2" filter="url(#lightGlow)"/>
      <text x="0" y="5" font-family="'Consolas', monospace" font-size="14" font-weight="bold" fill="#ffffff" text-anchor="middle">GPT-4o</text>
    </g>
    
    <!-- Subtitle -->
    <rect x="40" y="215" width="200" height="26" rx="4" fill="#0a0c14" stroke="#1f2536" stroke-width="1"/>
    <text x="140" y="232" font-family="'Consolas', monospace" font-size="11" fill="#8892b0" text-anchor="middle">Strict XML Output Parser</text>
  </g>


  <!-- ============================================== -->
  <!-- DYNAMIC DATA FLOWS (PIPELINES)                 -->
  <!-- ============================================== -->
  
  <!-- Flow 1: HTTP POST App to FastAPI -->
  <g>
    <path id="path-post" d="M 360 190 L 400 190 L 400 190 L 430 190" fill="none" stroke="#4facfe" stroke-width="2" marker-end="url(#arrow-cyan)" opacity="0.4"/>
    <circle r="3" fill="#00f2fe" filter="url(#glow-cyan)">
      <animateMotion dur="1.5s" repeatCount="indefinite" path="M 360 190 L 425 190"/>
    </circle>
    <text x="400" y="180" font-family="'Consolas', monospace" font-size="11" fill="#4facfe" text-anchor="middle">POST /execute</text>
  </g>

  <!-- Flow 2: BYOT Tool Injection App to SDK Registry -->
  <g>
    <path d="M 360 210 L 415 210 L 415 245 L 430 245" fill="none" class="data-beam" stroke="#00f2fe" stroke-width="2" stroke-dasharray="6 4" filter="url(#lightGlow)" opacity="0.6">
      <animate attributeName="stroke-dashoffset" values="20; 0" dur="1s" repeatCount="indefinite"/>
    </path>
    <text x="400" y="235" font-family="'Consolas', monospace" font-size="10" fill="#8892b0" text-anchor="middle">BYOT Injection</text>
  </g>

  <!-- Flow 3: LLM Inference (SDK Outbound) -->
  <g>
    <path d="M 760 210 L 830 210" fill="none" stroke="#00ff88" stroke-width="2" marker-end="url(#arrow-green)" opacity="0.4"/>
    <circle r="3" fill="#00ff88" filter="url(#glow-green)">
      <animateMotion dur="1.2s" repeatCount="indefinite" path="M 760 210 L 825 210"/>
    </circle>
    <text x="800" y="200" font-family="'Consolas', monospace" font-size="11" fill="#00ff88" text-anchor="middle">Dyn XML Prompt</text>
  </g>

  <!-- Flow 4: LLM Output (Gateway Inbound) -->
  <g>
    <path d="M 830 260 L 760 260" fill="none" stroke="#ff416c" stroke-width="2" marker-end="url(#arrow-orange)" opacity="0.4"/>
    <circle r="3" fill="#ff4b2b" filter="url(#glow-orange)">
      <animateMotion dur="1.2s" repeatCount="indefinite" path="M 830 260 L 765 260"/>
    </circle>
    <text x="800" y="280" font-family="'Consolas', monospace" font-size="11" fill="#ff416c" text-anchor="middle">Raw LLM Output</text>
  </g>

  <!-- Flow 5: SSE Stream (SDK back to App) -->
  <g>
    <path d="M 440 300 L 400 300 L 400 290 L 360 290" fill="none" stroke="#ff4b2b" stroke-width="2" marker-end="url(#arrow-orange)" opacity="0.4"/>
    <!-- Animated SSE pulses -->
    <circle r="4" fill="#ff4b2b" filter="url(#glow-orange)">
      <animateMotion dur="1.8s" repeatCount="indefinite" path="M 440 300 L 400 300 L 400 290 L 355 290"/>
    </circle>
    <circle r="4" fill="#ff416c" filter="url(#lightGlow)">
      <animateMotion dur="1.8s" begin="0.9s" repeatCount="indefinite" path="M 440 300 L 400 300 L 400 290 L 355 290"/>
    </circle>
    
    <text x="400" y="325" font-family="'Consolas', monospace" font-size="11" font-weight="bold" fill="#ff4b2b" text-anchor="middle" filter="url(#lightGlow)">yield JSON Stream</text>
  </g>

</svg>
