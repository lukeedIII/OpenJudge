<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 500" width="100%" height="100%">
  <defs>
    <!-- Deep Space Background -->
    <radialGradient id="bg" cx="50%" cy="50%" r="70%">
      <stop offset="0%" stop-color="#050811" />
      <stop offset="100%" stop-color="#010203" />
    </radialGradient>

    <!-- Glowing Line Filters (Subtle and Clean) -->
    <filter id="glow-cyan" x="-20%" y="-20%" width="140%" height="140%">
      <feGaussianBlur stdDeviation="3" result="blur" />
      <feMerge><feMergeNode in="blur" /><feMergeNode in="SourceGraphic" /></feMerge>
    </filter>
    <filter id="glow-orange" x="-20%" y="-20%" width="140%" height="140%">
      <feGaussianBlur stdDeviation="3" result="blur" />
      <feMerge><feMergeNode in="blur" /><feMergeNode in="SourceGraphic" /></feMerge>
    </filter>
    <filter id="glow-purple" x="-20%" y="-20%" width="140%" height="140%">
      <feGaussianBlur stdDeviation="3" result="blur" />
      <feMerge><feMergeNode in="blur" /><feMergeNode in="SourceGraphic" /></feMerge>
    </filter>
    <filter id="glow-green" x="-20%" y="-20%" width="140%" height="140%">
      <feGaussianBlur stdDeviation="3" result="blur" />
      <feMerge><feMergeNode in="blur" /><feMergeNode in="SourceGraphic" /></feMerge>
    </filter>
    <filter id="glow-magenta" x="-20%" y="-20%" width="140%" height="140%">
      <feGaussianBlur stdDeviation="3" result="blur" />
      <feMerge><feMergeNode in="blur" /><feMergeNode in="SourceGraphic" /></feMerge>
    </filter>

    <!-- Block Drop Shadows -->
    <filter id="shadow" x="-10%" y="-10%" width="120%" height="120%">
      <feDropShadow dx="0" dy="8" stdDeviation="15" flood-color="#000000" flood-opacity="0.8"/>
    </filter>

    <!-- Precise Directional Arrows -->
    <marker id="arrow-cyan" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#00f2fe"/>
    </marker>
    <marker id="arrow-orange" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#ff4b2b"/>
    </marker>
    <marker id="arrow-purple" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#a855f7"/>
    </marker>
    <marker id="arrow-green" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#00ff88"/>
    </marker>
    <marker id="arrow-magenta" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#ff0080"/>
    </marker>

    <!-- Architectural Background Grid -->
    <pattern id="grid" width="30" height="30" patternUnits="userSpaceOnUse">
      <path d="M 30 0 L 0 0 0 30" fill="none" stroke="rgba(255,255,255,0.03)" stroke-width="1"/>
    </pattern>

    <!-- Block Clip Path to contain internal animations -->
    <clipPath id="center-clip">
      <rect x="401" y="41" width="398" height="418" rx="15"/>
    </clipPath>
  </defs>

  <!-- ========================================== -->
  <!-- CANVAS LAYER                               -->
  <!-- ========================================== -->
  <rect width="1200" height="500" fill="url(#bg)"/>
  <rect width="1200" height="500" fill="url(#grid)"/>

  <!-- Top Headers for the 3 Major Pillars -->
  <text x="145" y="25" font-family="'Inter', Arial, sans-serif" font-weight="900" font-size="13" fill="#64748b" text-anchor="middle" letter-spacing="3">CLIENT ENVIRONMENT</text>
  <text x="600" y="25" font-family="'Inter', Arial, sans-serif" font-weight="900" font-size="13" fill="#94a3b8" text-anchor="middle" letter-spacing="3">OPENJUDGE V3 MICROSERVICE</text>
  <text x="1055" y="25" font-family="'Inter', Arial, sans-serif" font-weight="900" font-size="13" fill="#64748b" text-anchor="middle" letter-spacing="3">EXTERNAL LLM GATEWAY</text>


  <!-- ========================================== -->
  <!-- THE THREE ARCHITECTURAL PILLARS            -->
  <!-- ========================================== -->

  <!-- [1] LEFT PILLAR: CLIENT ENVIRONMENT -->
  <rect x="40" y="40" width="210" height="420" rx="16" fill="#0a0c14" stroke="#1f2536" stroke-width="2" filter="url(#shadow)"/>
  
  <!-- Left Pillar Sub-Nodes -->
  <g transform="translate(60, 90)">
    <rect width="170" height="60" rx="8" fill="#111624" stroke="#1f2536" stroke-width="1.5"/>
    <text x="85" y="26" font-family="'Inter', Arial, sans-serif" font-weight="bold" font-size="13" fill="#f8fafc" text-anchor="middle">Backend Server</text>
    <text x="85" y="44" font-family="'Consolas', monospace" font-size="11" fill="#64748b" text-anchor="middle">Node.js / Python</text>
  </g>

  <g transform="translate(60, 170)">
    <rect width="170" height="60" rx="8" fill="#111624" stroke="#ff4b2b" stroke-width="1.5" opacity="0.8"/>
    <text x="85" y="26" font-family="'Inter', Arial, sans-serif" font-weight="bold" font-size="13" fill="#f8fafc" text-anchor="middle">Observer UI</text>
    <text x="85" y="44" font-family="'Consolas', monospace" font-size="11" fill="#ff4b2b" text-anchor="middle" filter="url(#glow-orange)">React Dashboard</text>
  </g>

  <g transform="translate(60, 250)">
    <rect width="170" height="60" rx="8" fill="#111624" stroke="#1f2536" stroke-width="1.5"/>
    <text x="85" y="26" font-family="'Inter', Arial, sans-serif" font-weight="bold" font-size="13" fill="#f8fafc" text-anchor="middle">Custom SDK Tools</text>
    <text x="85" y="44" font-family="'Consolas', monospace" font-size="11" fill="#64748b" text-anchor="middle">Local Function logic</text>
  </g>

  <!-- [2] CENTER PILLAR: OPENJUDGE ENGINE -->
  <rect x="400" y="40" width="400" height="420" rx="16" fill="#050811" stroke="#334155" stroke-width="2" filter="url(#shadow)"/>
  <rect x="401" y="41" width="398" height="418" rx="15" fill="none" stroke="rgba(255,255,255,0.03)" stroke-width="1"/>
  
  <!-- Subtle Internal Vertical Scanning Animation representing the "Engine" -->
  <g clip-path="url(#center-clip)">
    <line x1="400" y1="0" x2="400" y2="500" stroke="#00f2fe" stroke-width="1.5" opacity="0.3" filter="url(#glow-cyan)">
      <animateTransform attributeName="transform" type="translate" values="0,0; 400,0; 0,0" dur="8s" repeatCount="indefinite" />
    </line>
  </g>

  <!-- Center Pillar Sub-Nodes -->
  <g transform="translate(430, 90)">
    <!-- Spans Y=90 to Y=230, catching both Y=120 and Y=200 Data Lanes -->
    <rect width="340" height="140" rx="12" fill="#0a0c14" stroke="#00f2fe" stroke-width="1.5" opacity="0.9"/>
    <text x="170" y="65" font-family="'Inter', Arial, sans-serif" font-weight="bold" font-size="16" fill="#00f2fe" text-anchor="middle" filter="url(#glow-cyan)">FastAPI Data Hub</text>
    <text x="170" y="85" font-family="'Consolas', monospace" font-size="12" fill="#94a3b8" text-anchor="middle">Async Request &amp; SSE Stream Controller</text>
  </g>

  <g transform="translate(430, 250)">
    <!-- Spans Y=250 to Y=310, catching Y=280 Lane -->
    <rect width="340" height="60" rx="12" fill="#0a0c14" stroke="#a855f7" stroke-width="1.5" opacity="0.9"/>
    <text x="170" y="35" font-family="'Inter', Arial, sans-serif" font-weight="bold" font-size="15" fill="#a855f7" text-anchor="middle" filter="url(#glow-purple)">Enterprise BYOT Registry</text>
  </g>

  <g transform="translate(430, 330)">
    <!-- Spans Y=330 to Y=440, catching Y=350 & Y=390 Lanes -->
    <rect width="340" height="110" rx="12" fill="#0a0c14" stroke="#00ff88" stroke-width="1.5" opacity="0.9"/>
    <!-- Internal ledger blinking light -->
    <circle cx="20" cy="20" r="4" fill="#00ff88" filter="url(#glow-green)">
       <animate attributeName="opacity" values="1;0.2;1" dur="1s" repeatCount="indefinite"/>
    </circle>
    <text x="170" y="55" font-family="'Inter', Arial, sans-serif" font-weight="bold" font-size="16" fill="#00ff88" text-anchor="middle" filter="url(#glow-green)">Verification Ledger</text>
    <text x="170" y="75" font-family="'Consolas', monospace" font-size="12" fill="#94a3b8" text-anchor="middle">State Manager &amp; Math Enforcement</text>
  </g>

  <!-- [3] RIGHT PILLAR: LLM GATEWAY -->
  <rect x="950" y="40" width="210" height="420" rx="16" fill="#0a0c14" stroke="#1f2536" stroke-width="2" filter="url(#shadow)"/>
  
  <g transform="translate(970, 90)">
    <!-- Spans Y=90 to Y=440 (Full height), effortlessly catching both LLM lanes -->
    <rect width="170" height="350" rx="12" fill="#111624" stroke="#ff0080" stroke-width="1.5" opacity="0.8"/>
    
    <!-- Abstract glowing neural core decoration -->
    <circle cx="85" cy="175" r="45" fill="none" stroke="#ff0080" stroke-width="2" filter="url(#glow-magenta)"/>
    <circle cx="85" cy="175" r="30" fill="none" stroke="#ff416c" stroke-width="1" stroke-dasharray="4 4">
      <animateTransform attributeName="transform" type="rotate" from="0 85 175" to="360 85 175" dur="10s" repeatCount="indefinite" />
    </circle>
    <circle cx="85" cy="175" r="10" fill="#ff0080" filter="url(#glow-magenta)">
      <animate attributeName="opacity" values="0.4;1;0.4" dur="2s" repeatCount="indefinite"/>
    </circle>
    
    <text x="85" y="160" font-family="'Inter', Arial, sans-serif" font-weight="900" font-size="16" fill="#f8fafc" text-anchor="middle">GPT-4o</text>
    <text x="85" y="250" font-family="'Consolas', monospace" font-size="11" fill="#94a3b8" text-anchor="middle">Strict XML Output Parser</text>
  </g>


  <!-- ============================================== -->
  <!-- PERFECTLY RIGID HORIZONTAL DATA LANES          -->
  <!-- ============================================== -->
  
  <!-- LANE 1: POST /execute (Left -> Center at Y=120) -->
  <g>
    <!-- Background Track -->
    <line x1="250" y1="120" x2="400" y2="120" stroke="#1f2536" stroke-width="2"/>
    <!-- Animated Dash Line -->
    <line x1="250" y1="120" x2="390" y2="120" stroke="#00f2fe" stroke-width="2" stroke-dasharray="5 5" marker-end="url(#arrow-cyan)">
      <animate attributeName="stroke-dashoffset" values="10; 0" dur="0.8s" repeatCount="indefinite" />
    </line>
    <!-- Particle Packet -->
    <circle r="4" fill="#00f2fe" filter="url(#glow-cyan)">
      <animateMotion dur="1s" repeatCount="indefinite" path="M 250 120 L 390 120"/>
    </circle>
    <!-- Text Label -->
    <text x="325" y="110" font-family="'Consolas', monospace" font-size="11" font-weight="bold" fill="#00f2fe" text-anchor="middle" filter="url(#glow-cyan)">POST /execute</text>
  </g>

  <!-- LANE 2: SSE Telemetry JSON Stream (Center -> Left at Y=200) -->
  <g>
    <!-- Background Track -->
    <line x1="400" y1="200" x2="250" y2="200" stroke="#1f2536" stroke-width="2"/>
    <!-- Thick Solid Stream glowing line -->
    <line x1="390" y1="200" x2="260" y2="200" stroke="#ff4b2b" stroke-width="4" marker-end="url(#arrow-orange)" filter="url(#glow-orange)" opacity="0.6"/>
    <!-- Packet 1 -->
    <circle r="5" fill="#ff4b2b" filter="url(#glow-orange)">
      <animateMotion dur="1.5s" repeatCount="indefinite" path="M 400 200 L 250 200"/>
      <animate attributeName="opacity" values="1; 0.2" dur="1.5s" repeatCount="indefinite"/>
    </circle>
    <!-- Packet 2 -->
    <circle r="5" fill="#ff4b2b" filter="url(#glow-orange)">
      <animateMotion dur="1.5s" begin="0.75s" repeatCount="indefinite" path="M 400 200 L 250 200"/>
      <animate attributeName="opacity" values="1; 0.2" dur="1.5s" repeatCount="indefinite"/>
    </circle>
    <!-- Text Label -->
    <text x="325" y="190" font-family="'Consolas', monospace" font-size="11" font-weight="bold" fill="#ff4b2b" text-anchor="middle" filter="url(#glow-orange)">SSE JSON Stream</text>
  </g>

  <!-- LANE 3: BYOT Tool Injection (Left -> Center at Y=280) -->
  <g>
    <line x1="250" y1="280" x2="400" y2="280" stroke="#1f2536" stroke-width="2"/>
    <line x1="250" y1="280" x2="390" y2="280" stroke="#a855f7" stroke-width="3" stroke-dasharray="8 8" marker-end="url(#arrow-purple)">
      <animate attributeName="stroke-dashoffset" values="16; 0" dur="1s" repeatCount="indefinite" />
    </line>
    <!-- Packet -->
    <rect x="-6" y="-3" width="12" height="6" rx="2" fill="#a855f7" filter="url(#glow-purple)">
      <animateMotion dur="1.2s" repeatCount="indefinite" path="M 250 280 L 390 280" rotate="auto"/>
    </rect>
    <text x="325" y="270" font-family="'Consolas', monospace" font-size="11" font-weight="bold" fill="#a855f7" text-anchor="middle" filter="url(#glow-purple)">Inject SDK Tools</text>
  </g>

  <!-- LANE 4: XML System Prompt Context (Center -> Right at Y=350) -->
  <g>
    <line x1="800" y1="350" x2="950" y2="350" stroke="#1f2536" stroke-width="2"/>
    <line x1="800" y1="350" x2="940" y2="350" stroke="#00ff88" stroke-width="3" stroke-dasharray="12 6" marker-end="url(#arrow-green)">
      <animate attributeName="stroke-dashoffset" values="18; 0" dur="0.8s" repeatCount="indefinite" />
    </line>
    <circle r="4" fill="#00ff88" filter="url(#glow-green)">
      <animateMotion dur="1.2s" repeatCount="indefinite" path="M 800 350 L 940 350"/>
    </circle>
    <text x="875" y="340" font-family="'Consolas', monospace" font-size="11" font-weight="bold" fill="#00ff88" text-anchor="middle" filter="url(#glow-green)">Dynamic XML Prompt</text>
  </g>

  <!-- LANE 5: Raw XML Output Response (Right -> Center at Y=390) -->
  <g>
    <line x1="950" y1="390" x2="800" y2="390" stroke="#1f2536" stroke-width="2"/>
    <line x1="950" y1="390" x2="810" y2="390" stroke="#ff0080" stroke-width="3" stroke-dasharray="2 12" marker-end="url(#arrow-magenta)">
      <animate attributeName="stroke-dashoffset" values="0; 14" dur="0.5s" repeatCount="indefinite" />
    </line>
    <!-- High frequency token emulation dots -->
    <circle r="2.5" fill="#ff0080" filter="url(#glow-magenta)">
      <animateMotion dur="0.6s" repeatCount="indefinite" path="M 950 390 L 810 390"/>
    </circle>
    <circle r="2.5" fill="#ff0080" filter="url(#glow-magenta)">
      <animateMotion dur="0.6s" begin="0.2s" repeatCount="indefinite" path="M 950 390 L 810 390"/>
    </circle>
    <circle r="2.5" fill="#ff0080" filter="url(#glow-magenta)">
      <animateMotion dur="0.6s" begin="0.4s" repeatCount="indefinite" path="M 950 390 L 810 390"/>
    </circle>
    <text x="875" y="380" font-family="'Consolas', monospace" font-size="11" font-weight="bold" fill="#ff0080" text-anchor="middle" filter="url(#glow-magenta)">Raw XML Generation</text>
  </g>

</svg>
